# Классификация клиентских запросов в банковской сфере

## Описание проекта

Данный проект представляет собой **end-to-end ML-систему** для классификации текстовых запросов клиентов банка по определенному типу.

Проект построен на основе открытого датасета [**PolyAI/banking77**](https://huggingface.co/datasets/PolyAI/banking77) и охватывает такие этапы разработки как:

- исследование данных;
- обучение и сравнение моделей;
- трекинг экспериментов;
- деплой модели;
- backend API;
- frontend demo;
- контейнеризация и базовые MLOps-практики;

**Задача проекта** — автоматически определять тип клиентского запроса, чтобы маршрутизировать его в нужный сервис, автоматизировать ответы, сократить нагрузку на операторов.

## Датасет

Используется датасет **Banking77**, который:

- имеет 77 классов (типов клиентских обращений);
- состоит из 13 083 текстовых запросов;
- представляет собой реальную банковскую тематику

## ML-подходы, реализованные в проекте

В проекте сравниваются **несколько классов моделей**:

### Классический Machine Learning

Текст очищается, векторизуется, затем на основе векторного представления текста используются следующие алгоритмы машинного обучения:

- Logistic Regression
- Linear SVM
- Multinomial Naive Bayes

### Deep Learning

В качестве продвинутого варианта решения поставленной задачи используются архитектуры реккурентных нейронных сетей:

- RNN
- LSTM
- GRU

### Transformers

Являются наиболее эффективной технологией в решении задач классификации текстовых документов. Взяты следующие модели:

- BERT
- DistilBERT
- Fine-tuning через Hugging Face Transformers

Все эксперименты логируются и сравниваются с помощью **MLflow**.

## Архитектура решения

### Общая архитектура

```
Frontend (Streamlit)
        ↓
FastAPI Backend
        ↓
ML Service Layer
        ↓
MLflow Model Registry
        ↓
PostgreSQL (логи и предсказания)
```

### Pipeline обучения

```
Датасет → Предобработка → Feature Engineering → Обучение моделей → Предсказания → MLflow Tracking → Регистрация моделей
```

### Pipeline инференса

```
Запрос клиента → API → Модель → Предсказания → БД → Ответ
```

## Технологический стек

### Основные технологии

- **Python 3.11**
- **Poetry**
- **scikit-learn**
- **PyTorch**
- **Hugging Face Transformers**
- **MLflow**
- **FastAPI**
- **PostgreSQL**
- **Docker / docker-compose**
- **Streamlit**

## Структура репозитория

```
banking-intent-classifier/
│
├── data/               # Данные
├── notebooks/          # Исследования и эксперименты
├── src/                # ML-ядро проекта
├── backend/            # FastAPI backend
├── frontend/           # Streamlit
├── docker/             # Docker-инфраструктура
├── tests/              # Тесты
│
├── docker-compose.yml
├── pyproject.toml
├── .env.example
└── README.md
```

## Краткая инструкция по запуску проекта

```bash
git clone https://github.com/KiriLLchik07/Classification-of-customer-requests-in-the-banking-sector.git
cd Classification-of-customer-requests-in-the-banking-sector

# установка зависимостей
poetry install

# запуск сервисов
docker-compose up --build
```

(Подробная инструкция будет дополняться по мере развития проекта)

## Результаты

В проекте проводится:

- сравнение всех подходов по метрикам Accuracy / F1-macro;
- анализ ошибок;
- выбор наилучшей модели

Итоговая модель регистрируется в **MLflow Model Registry** и используется в API.
